import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,b as e}from"./app-DrsE8OIX.js";const t={},p=e(`<h2 id="rsync自动交互" tabindex="-1"><a class="header-anchor" href="#rsync自动交互"><span>rsync自动交互</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">KB_PATH</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> sca-engine <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $1}&#39;</span> <span class="token operator">|</span> <span class="token function">xargs</span> -I% <span class="token function">sudo</span> <span class="token function">docker</span> inspect % <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A</span> <span class="token number">40</span> Mounts <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-B</span> <span class="token number">2</span> <span class="token string">&#39;/var/lib/ldb&#39;</span> <span class="token operator">|</span> <span class="token function">grep</span> Source <span class="token operator">|</span> <span class="token function">cut</span> -d: <span class="token parameter variable">-f</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token function">cut</span> -d, <span class="token parameter variable">-f</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token punctuation">\\</span>&quot; <span class="token parameter variable">-f</span> <span class="token number">2</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;知识库路径：<span class="token variable">$KB_PATH</span>&quot;</span>
<span class="token function-name function">rsynczd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span> <span class="token operator">&lt;&lt;-</span>EOF
        <span class="token builtin class-name">set</span> <span class="token function">timeout</span> <span class="token number">10</span>
        spawn <span class="token function">rsync</span> <span class="token parameter variable">-av</span> <span class="token parameter variable">--progres</span> <span class="token variable">$user</span>@<span class="token variable">$ip</span>:/home/sectrend/kb_updates <span class="token variable">$KB_PATH</span>/kb_updates
        <span class="token function">expect</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;yes/no&quot;</span> <span class="token punctuation">{</span> send <span class="token string">&quot;yes<span class="token entity" title="\\n">\\n</span>&quot;</span><span class="token punctuation">;</span>exp_continue <span class="token punctuation">}</span>
            <span class="token string">&quot;password&quot;</span> <span class="token punctuation">{</span> send <span class="token string">&quot;<span class="token variable">$password</span><span class="token entity" title="\\n">\\n</span>&quot;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">expect</span> EOF
    EOF
<span class="token punctuation">}</span>
<span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable">$3</span>
rsynczd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),o=[p];function c(l,i){return s(),a("div",null,o)}const d=n(t,[["render",c],["__file","expect.html.vue"]]),k=JSON.parse('{"path":"/shell_script/expect.html","title":"expect自动交互","lang":"zh-CN","frontmatter":{"title":"expect自动交互","catalog":"Shell","icon":"tools","description":"rsync自动交互","head":[["meta",{"property":"og:url","content":"https://yuhaoxiang.github.io/work-blog/work-blog/shell_script/expect.html"}],["meta",{"property":"og:site_name","content":"大杂烩"}],["meta",{"property":"og:title","content":"expect自动交互"}],["meta",{"property":"og:description","content":"rsync自动交互"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-28T08:47:19.000Z"}],["meta",{"property":"article:author","content":"yhx"}],["meta",{"property":"article:modified_time","content":"2024-04-28T08:47:19.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"expect自动交互\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-28T08:47:19.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"yhx\\",\\"url\\":\\"/\\"}]}"]]},"headers":[{"level":2,"title":"rsync自动交互","slug":"rsync自动交互","link":"#rsync自动交互","children":[]}],"git":{"createdTime":1714294039000,"updatedTime":1714294039000,"contributors":[{"name":"haoxiang.yu@sectrend.com.cn","email":"ZLJw5dEMQLaVgsP","commits":1}]},"readingTime":{"minutes":0.32,"words":96},"filePathRelative":"shell_script/expect.md","localizedDate":"2024年4月28日","autoDesc":true}');export{d as comp,k as data};
